<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Package test_advection_tidal</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Types&nbsp;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="namespacemembers.html"><span>Package&nbsp;Functions</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Package test_advection_tidal<br>
<small>
[<a class="el" href="a00097.html">test_transport</a>]</small>
</h1>Testing <a class="el" href="a00052.html" title="Module orchestrating the advection scheme. The main routine in the module is advection()...">advection</a> of mass which is subjected to a tidal boundary.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#a641e8962260d8ad121308cc9b47f0ba">tidal_flow</a> (flow,flow_lo,flow_hi,area,area_lo,area_hi,ncell,time,dx,dt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">generates a tidal flow to feed a pointer  <a href="#a641e8962260d8ad121308cc9b47f0ba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0d1b166fc5d9d02326552a191ff9680"></a><!-- doxytag: member="test_advection_tidal::test_tidal_advection_convergence" ref="a0d1b166fc5d9d02326552a191ff9680" args="" -->
subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><b>test_tidal_advection_convergence</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cc0b84a83a06778691b434d900dbb346"></a><!-- doxytag: member="test_advection_tidal::test_tidal_advection_convergence" ref="cc0b84a83a06778691b434d900dbb346" args="(verbose)" -->
subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#cc0b84a83a06778691b434d900dbb346">test_tidal_advection_convergence</a> (verbose)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tests the convergence of error rate in <a class="el" href="a00052.html" title="Module orchestrating the advection scheme. The main routine in the module is advection()...">advection</a> of mass which is exposed a tidal boundary. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#274a3add96450377dc8a8b3a940b9b92">initial_fine_solution_tidal</a> (fine_initial_condition, fine_solution, nx_base, nconc, <a class="el" href="a00075.html#ace3ff1fc926161c0767e4cf71ef4312">origin</a>, <a class="el" href="a00075.html#a6e296389f1fbf10fb55683356df7be1">domain_length</a>, ic_gaussian_sd, solution_gaussin_sd, ic_center, solution_center)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">load the initial values and reference final values to feed the test routine  <a href="#274a3add96450377dc8a8b3a940b9b92"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ace3ff1fc926161c0767e4cf71ef4312"></a><!-- doxytag: member="test_advection_tidal::origin" ref="ace3ff1fc926161c0767e4cf71ef4312" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#ace3ff1fc926161c0767e4cf71ef4312">origin</a> = zero</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Left hand side of the channel. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a6e296389f1fbf10fb55683356df7be1"></a><!-- doxytag: member="test_advection_tidal::domain_length" ref="a6e296389f1fbf10fb55683356df7be1" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#a6e296389f1fbf10fb55683356df7be1">domain_length</a> = 409600.0d0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Domain Length in meter. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2b3ee0d2446b5421bec1fcfe8e8e1fde"></a><!-- doxytag: member="test_advection_tidal::amp" ref="2b3ee0d2446b5421bec1fcfe8e8e1fde" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><b>amp</b> = half</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="25f72425a266f85ce3c78fa73d64ac6f"></a><!-- doxytag: member="test_advection_tidal::gravity" ref="25f72425a266f85ce3c78fa73d64ac6f" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#25f72425a266f85ce3c78fa73d64ac6f">gravity</a> = 9.80d0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gravitational acceleration in m/s^2. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b206455496b74bfe98d345daafd3e7c2"></a><!-- doxytag: member="test_advection_tidal::depth" ref="b206455496b74bfe98d345daafd3e7c2" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#b206455496b74bfe98d345daafd3e7c2">depth</a> = 16.0d0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Channel depth in meter. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e16f52b0a564526244bf457adac0b088"></a><!-- doxytag: member="test_advection_tidal::omega" ref="e16f52b0a564526244bf457adac0b088" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><b>omega</b> = 0.506708d0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1b90d1dfb2dc693e901a30c34faba86b"></a><!-- doxytag: member="test_advection_tidal::big_a" ref="1b90d1dfb2dc693e901a30c34faba86b" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><b>big_a</b> = 0.4188704167062d0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eb31b4bae6845768030484bed978a90a"></a><!-- doxytag: member="test_advection_tidal::big_b" ref="eb31b4bae6845768030484bed978a90a" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><b>big_b</b> = 0.040465522644d0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eb86253215997660050af69310064623"></a><!-- doxytag: member="test_advection_tidal::k_0" ref="eb86253215997660050af69310064623" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><b>k_0</b> = 10.066637844459d0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3d1a8e7d7d206a6c8c4d8565ae42d4c4"></a><!-- doxytag: member="test_advection_tidal::start_time" ref="3d1a8e7d7d206a6c8c4d8565ae42d4c4" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><b>start_time</b> = zero</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="388d4f0c2ae48eae0d24c20926515581"></a><!-- doxytag: member="test_advection_tidal::end_time" ref="388d4f0c2ae48eae0d24c20926515581" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><b>end_time</b> = 124d0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="21dd7d4370f255884d0575af7c1f72d2"></a><!-- doxytag: member="test_advection_tidal::amplitude" ref="21dd7d4370f255884d0575af7c1f72d2" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#21dd7d4370f255884d0575af7c1f72d2">amplitude</a> = fourth</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tidal amplitude in meter. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="95529fc80d0c9206dee17d7defe1cd1c"></a><!-- doxytag: member="test_advection_tidal::sec_per_hr" ref="95529fc80d0c9206dee17d7defe1cd1c" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#95529fc80d0c9206dee17d7defe1cd1c">sec_per_hr</a> = 60.d0*60.d0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert factor of hour to second. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7069493925339bc094dc5d9e66a6ca3e"></a><!-- doxytag: member="test_advection_tidal::m2_period" ref="7069493925339bc094dc5d9e66a6ca3e" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#7069493925339bc094dc5d9e66a6ca3e">m2_period</a> = 12.4d0*sec_per_hr</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">M2 tidal period. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="685c107d67e4166e5c47350e344ff0e1"></a><!-- doxytag: member="test_advection_tidal::freq" ref="685c107d67e4166e5c47350e344ff0e1" args="" -->
real(stm_real), parameter&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00075.html#685c107d67e4166e5c47350e344ff0e1">freq</a> = two*pi/<a class="el" href="a00075.html#7069493925339bc094dc5d9e66a6ca3e">m2_period</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Frequency of tidal oscillation. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Testing <a class="el" href="a00052.html" title="Module orchestrating the advection scheme. The main routine in the module is advection()...">advection</a> of mass which is subjected to a tidal boundary. 
<p>
<hr><h2>Function/Subroutine Documentation</h2>
<a class="anchor" name="274a3add96450377dc8a8b3a940b9b92"></a><!-- doxytag: member="test_advection_tidal::initial_fine_solution_tidal" ref="274a3add96450377dc8a8b3a940b9b92" args="(fine_initial_condition, fine_solution, nx_base, nconc, origin, domain_length, ic_gaussian_sd, solution_gaussin_sd, ic_center, solution_center)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine test_advection_tidal.initial_fine_solution_tidal           </td>
          <td>(</td>
          <td class="paramtype">real(stm_real),dimension(nx_base,nconc),intent(out)&nbsp;</td>
          <td class="paramname"> <em>fine_initial_condition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),dimension(nx_base,nconc),intent(out)&nbsp;</td>
          <td class="paramname"> <em>fine_solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&nbsp;</td>
          <td class="paramname"> <em>nx_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&nbsp;</td>
          <td class="paramname"> <em>nconc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>domain_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>ic_gaussian_sd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>solution_gaussin_sd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>ic_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>solution_center</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
load the initial values and reference final values to feed the test routine 
<p>
The general subroutine which gets the fine initial and reference values from the privious subroutine and compute the norms, after each step coarsen the values and repeat computation. at the end calculates the ratio of the norms and prints a log Generates a fine initial and final solution of mass <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fine_initial_condition</em>&nbsp;</td><td>initial condition at finest resolution</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fine_solution</em>&nbsp;</td><td>reference solution at finest resolution</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>origin</em>&nbsp;</td><td>Left hand side of the channel</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>domain_length</em>&nbsp;</td><td>Domain length</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ic_gaussian_sd</em>&nbsp;</td><td>Standard deviation of initial value</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>solution_gaussin_sd</em>&nbsp;</td><td>Standard deviation of solution </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ic_center</em>&nbsp;</td><td>Center of fine initial value</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>solution_center</em>&nbsp;</td><td>Center of solution </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="a641e8962260d8ad121308cc9b47f0ba"></a><!-- doxytag: member="test_advection_tidal::tidal_flow" ref="a641e8962260d8ad121308cc9b47f0ba" args="(flow,flow_lo,flow_hi,area,area_lo,area_hi,ncell,time,dx,dt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine test_advection_tidal::tidal_flow           </td>
          <td>(</td>
          <td class="paramtype">real(stm_real),dimension(ncell),intent(out)&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),dimension(ncell),intent(out)&nbsp;</td>
          <td class="paramname"> <em>flow_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),dimension(ncell),intent(out)&nbsp;</td>
          <td class="paramname"> <em>flow_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),dimension(ncell),intent(out)&nbsp;</td>
          <td class="paramname"> <em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),dimension(ncell),intent(out)&nbsp;</td>
          <td class="paramname"> <em>area_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),dimension(ncell),intent(out)&nbsp;</td>
          <td class="paramname"> <em>area_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer,intent(in)&nbsp;</td>
          <td class="paramname"> <em>ncell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(stm_real),intent(in)&nbsp;</td>
          <td class="paramname"> <em>dt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
generates a tidal flow to feed a pointer 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>cell and time centered flow</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow_lo</em>&nbsp;</td><td>lo face flow, time centered</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow_hi</em>&nbsp;</td><td>hi face flow, time centered</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>area</em>&nbsp;</td><td>cell center area, old time</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>area_lo</em>&nbsp;</td><td>area lo face, time centered</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>area_hi</em>&nbsp;</td><td>area hi face, time centered</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ncell</em>&nbsp;</td><td>number of cells</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>time</em>&nbsp;</td><td>time of request "old time"</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dx</em>&nbsp;</td><td>spatial step </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dt</em>&nbsp;</td><td>time step </td></tr>
  </table>
</dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Aug 11 16:26:11 2010 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
