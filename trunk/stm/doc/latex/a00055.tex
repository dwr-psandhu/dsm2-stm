\hypertarget{a00055}{
\section{Package boundary\_\-diffusion\_\-matrix\_\-module}
\label{a00055}\index{boundary\_\-diffusion\_\-matrix\_\-module@{boundary\_\-diffusion\_\-matrix\_\-module}}
}
boundary diffusive matrix \hyperlink{a00003}{interface} to be fulfilled by driver or application  


\subsection*{Data Types}
\begin{CompactItemize}
\item 
interface \hyperlink{a00003}{interface}
\begin{CompactList}\small\item\em Calculate boundary \hyperlink{a00056}{diffusion} matrix. \item\end{CompactList}\end{CompactItemize}
\subsection*{Functions/Subroutines}
\begin{CompactItemize}
\item 
subroutine \hyperlink{a00055_1519a5a563e79c544b761ce6f9e5e55f}{uninitialized\_\-diffusive\_\-bc\_\-matrix} (center\_\-diag, up\_\-diag, down\_\-diag, area, area\_\-lo, area\_\-hi, disp\_\-coef\_\-lo, disp\_\-coef\_\-hi, theta\_\-stm, ncell, time, nvar, dx, dt)
\begin{CompactList}\small\item\em This pointer should be set by the driver or client code to specify the treatment at the first and last row of coefficient matrix. \item\end{CompactList}\item 
subroutine \hyperlink{a00055_bfeec91e611887da43beb5b8a58614fc}{neumann\_\-no\_\-flow\_\-matrix} (center\_\-diag, up\_\-diag, down\_\-diag, area, area\_\-lo, area\_\-hi, disp\_\-coef\_\-lo, disp\_\-coef\_\-hi, theta\_\-stm, ncell, time, nvar, dx, dt)
\begin{CompactList}\small\item\em Example diffusive flux that imposes Neumann boundaries with zero flux at both ends of the channel. \item\end{CompactList}\end{CompactItemize}


\subsection{Detailed Description}
boundary diffusive matrix \hyperlink{a00003}{interface} to be fulfilled by driver or application 



\subsection{Function/Subroutine Documentation}
\hypertarget{a00055_bfeec91e611887da43beb5b8a58614fc}{
\index{boundary\_\-diffusion\_\-matrix\_\-module@{boundary\_\-diffusion\_\-matrix\_\-module}!neumann\_\-no\_\-flow\_\-matrix@{neumann\_\-no\_\-flow\_\-matrix}}
\index{neumann\_\-no\_\-flow\_\-matrix@{neumann\_\-no\_\-flow\_\-matrix}!boundary_diffusion_matrix_module@{boundary\_\-diffusion\_\-matrix\_\-module}}
\subsubsection[{neumann\_\-no\_\-flow\_\-matrix}]{\setlength{\rightskip}{0pt plus 5cm}subroutine boundary\_\-diffusion\_\-matrix\_\-module.neumann\_\-no\_\-flow\_\-matrix (real(stm\_\-real),dimension(ncell,nvar),intent(inout) {\em center\_\-diag}, \/  real(stm\_\-real),dimension(ncell,nvar),intent(inout) {\em up\_\-diag}, \/  real(stm\_\-real),dimension(ncell,nvar),intent(inout) {\em down\_\-diag}, \/  real(stm\_\-real),dimension (ncell),intent(in) {\em area}, \/  real(stm\_\-real),dimension(ncell),intent(in) {\em area\_\-lo}, \/  real(stm\_\-real),dimension(ncell),intent(in) {\em area\_\-hi}, \/  real(stm\_\-real),dimension (ncell,nvar),intent(in) {\em disp\_\-coef\_\-lo}, \/  real(stm\_\-real),dimension (ncell,nvar),intent(in) {\em disp\_\-coef\_\-hi}, \/  real(stm\_\-real),intent(in) {\em theta\_\-stm}, \/  integer,intent(in) {\em ncell}, \/  real(stm\_\-real),intent(in) {\em time}, \/  integer,intent(in) {\em nvar}, \/  real(stm\_\-real),intent(in) {\em dx}, \/  real(stm\_\-real),intent(in) {\em dt})}}
\label{a00055_bfeec91e611887da43beb5b8a58614fc}


Example diffusive flux that imposes Neumann boundaries with zero flux at both ends of the channel. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em center\_\-diag}]Values of the coefficients at the diagonal in matrix\item[{\em up\_\-diag}]Values of the coefficients above the diagonal in matrix\item[{\em down\_\-diag}]Values of the coefficients below diagonal in matrix\item[{\em area}]Cell centered area at new time \item[{\em area\_\-lo}]Low side area at new time\item[{\em area\_\-hi}]High side area at new time \item[{\em disp\_\-coef\_\-lo}]Low side constituent dispersion coef. at new time\item[{\em disp\_\-coef\_\-hi}]High side constituent dispersion coef. at new time\item[{\em theta\_\-stm}]Explicitness coefficient; 0 is explicit, 0.5 Crank-Nicolson, 1 full implicit \item[{\em ncell}]Number of cells\item[{\em time}]Current time\item[{\em nvar}]Number of variables\item[{\em dx}]Spatial step \item[{\em dt}]Time step \end{description}
\end{Desc}
\hypertarget{a00055_1519a5a563e79c544b761ce6f9e5e55f}{
\index{boundary\_\-diffusion\_\-matrix\_\-module@{boundary\_\-diffusion\_\-matrix\_\-module}!uninitialized\_\-diffusive\_\-bc\_\-matrix@{uninitialized\_\-diffusive\_\-bc\_\-matrix}}
\index{uninitialized\_\-diffusive\_\-bc\_\-matrix@{uninitialized\_\-diffusive\_\-bc\_\-matrix}!boundary_diffusion_matrix_module@{boundary\_\-diffusion\_\-matrix\_\-module}}
\subsubsection[{uninitialized\_\-diffusive\_\-bc\_\-matrix}]{\setlength{\rightskip}{0pt plus 5cm}subroutine boundary\_\-diffusion\_\-matrix\_\-module.uninitialized\_\-diffusive\_\-bc\_\-matrix (real(stm\_\-real),dimension(ncell,nvar),intent(inout) {\em center\_\-diag}, \/  real(stm\_\-real),dimension(ncell,nvar),intent(inout) {\em up\_\-diag}, \/  real(stm\_\-real),dimension(ncell,nvar),intent(inout) {\em down\_\-diag}, \/  real(stm\_\-real),dimension (ncell),intent(in) {\em area}, \/  real(stm\_\-real),dimension(ncell),intent(in) {\em area\_\-lo}, \/  real(stm\_\-real),dimension(ncell),intent(in) {\em area\_\-hi}, \/  real(stm\_\-real),dimension (ncell,nvar),intent(in) {\em disp\_\-coef\_\-lo}, \/  real(stm\_\-real),dimension (ncell,nvar),intent(in) {\em disp\_\-coef\_\-hi}, \/  real(stm\_\-real),intent(in) {\em theta\_\-stm}, \/  integer,intent(in) {\em ncell}, \/  real(stm\_\-real),intent(in) {\em time}, \/  integer,intent(in) {\em nvar}, \/  real(stm\_\-real),intent(in) {\em dx}, \/  real(stm\_\-real),intent(in) {\em dt})}}
\label{a00055_1519a5a563e79c544b761ce6f9e5e55f}


This pointer should be set by the driver or client code to specify the treatment at the first and last row of coefficient matrix. 

Example matrix that prints an error and bails \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em center\_\-diag}]Values of the coefficients at the diagonal in matrix\item[{\em up\_\-diag}]Values of the coefficients above the diagonal in matrix\item[{\em down\_\-diag}]Values of the coefficients below diagonal in matrix\item[{\em area}]Cell centered area at new time \item[{\em area\_\-lo}]Low side area at new time\item[{\em area\_\-hi}]High side area at new time \item[{\em disp\_\-coef\_\-lo}]Low side constituent dispersion coef. at new time\item[{\em disp\_\-coef\_\-hi}]High side constituent dispersion coef. at new time\item[{\em theta\_\-stm}]Explicitness coefficient; 0 is explicit, 0.5 Crank-Nicolson, 1 full implicit \item[{\em ncell}]Number of cells\item[{\em time}]Current time\item[{\em nvar}]Number of variables\item[{\em dx}]Spatial step \item[{\em dt}]Time step \end{description}
\end{Desc}
