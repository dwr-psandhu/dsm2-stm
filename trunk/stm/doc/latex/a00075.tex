\hypertarget{a00075}{
\section{Package test\_\-advection\_\-tidal}
\label{a00075}\index{test\_\-advection\_\-tidal@{test\_\-advection\_\-tidal}}
}
Testing \hyperlink{a00052}{advection} of mass which is subjected to a tidal boundary.  


\subsection*{Functions/Subroutines}
\begin{CompactItemize}
\item 
subroutine \hyperlink{a00075_a641e8962260d8ad121308cc9b47f0ba}{tidal\_\-flow} (flow,flow\_\-lo,flow\_\-hi,area,area\_\-lo,area\_\-hi,ncell,time,dx,dt)
\begin{CompactList}\small\item\em generates a tidal flow to feed a pointer \item\end{CompactList}\item 
\hypertarget{a00075_a0d1b166fc5d9d02326552a191ff9680}{
subroutine \textbf{test\_\-tidal\_\-advection\_\-convergence}}
\label{a00075_a0d1b166fc5d9d02326552a191ff9680}

\item 
\hypertarget{a00075_cc0b84a83a06778691b434d900dbb346}{
subroutine \hyperlink{a00075_cc0b84a83a06778691b434d900dbb346}{test\_\-tidal\_\-advection\_\-convergence} (verbose)}
\label{a00075_cc0b84a83a06778691b434d900dbb346}

\begin{CompactList}\small\item\em Tests the convergence of error rate in \hyperlink{a00052}{advection} of mass which is exposed a tidal boundary. \item\end{CompactList}\item 
subroutine \hyperlink{a00075_274a3add96450377dc8a8b3a940b9b92}{initial\_\-fine\_\-solution\_\-tidal} (fine\_\-initial\_\-condition, fine\_\-solution, nx\_\-base, nconc, \hyperlink{a00075_ace3ff1fc926161c0767e4cf71ef4312}{origin}, \hyperlink{a00075_a6e296389f1fbf10fb55683356df7be1}{domain\_\-length}, ic\_\-gaussian\_\-sd, solution\_\-gaussin\_\-sd, ic\_\-center, solution\_\-center)
\begin{CompactList}\small\item\em load the initial values and reference final values to feed the test routine \item\end{CompactList}\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
\hypertarget{a00075_ace3ff1fc926161c0767e4cf71ef4312}{
real(stm\_\-real), parameter \hyperlink{a00075_ace3ff1fc926161c0767e4cf71ef4312}{origin} = zero}
\label{a00075_ace3ff1fc926161c0767e4cf71ef4312}

\begin{CompactList}\small\item\em Left hand side of the channel. \item\end{CompactList}\item 
\hypertarget{a00075_a6e296389f1fbf10fb55683356df7be1}{
real(stm\_\-real), parameter \hyperlink{a00075_a6e296389f1fbf10fb55683356df7be1}{domain\_\-length} = 409600.0d0}
\label{a00075_a6e296389f1fbf10fb55683356df7be1}

\begin{CompactList}\small\item\em Domain Length in meter. \item\end{CompactList}\item 
\hypertarget{a00075_2b3ee0d2446b5421bec1fcfe8e8e1fde}{
real(stm\_\-real), parameter \textbf{amp} = half}
\label{a00075_2b3ee0d2446b5421bec1fcfe8e8e1fde}

\item 
\hypertarget{a00075_25f72425a266f85ce3c78fa73d64ac6f}{
real(stm\_\-real), parameter \hyperlink{a00075_25f72425a266f85ce3c78fa73d64ac6f}{gravity} = 9.80d0}
\label{a00075_25f72425a266f85ce3c78fa73d64ac6f}

\begin{CompactList}\small\item\em Gravitational acceleration in m/s$^\wedge$2. \item\end{CompactList}\item 
\hypertarget{a00075_b206455496b74bfe98d345daafd3e7c2}{
real(stm\_\-real), parameter \hyperlink{a00075_b206455496b74bfe98d345daafd3e7c2}{depth} = 16.0d0}
\label{a00075_b206455496b74bfe98d345daafd3e7c2}

\begin{CompactList}\small\item\em Channel depth in meter. \item\end{CompactList}\item 
\hypertarget{a00075_e16f52b0a564526244bf457adac0b088}{
real(stm\_\-real), parameter \textbf{omega} = 0.506708d0}
\label{a00075_e16f52b0a564526244bf457adac0b088}

\item 
\hypertarget{a00075_1b90d1dfb2dc693e901a30c34faba86b}{
real(stm\_\-real), parameter \textbf{big\_\-a} = 0.4188704167062d0}
\label{a00075_1b90d1dfb2dc693e901a30c34faba86b}

\item 
\hypertarget{a00075_eb31b4bae6845768030484bed978a90a}{
real(stm\_\-real), parameter \textbf{big\_\-b} = 0.040465522644d0}
\label{a00075_eb31b4bae6845768030484bed978a90a}

\item 
\hypertarget{a00075_eb86253215997660050af69310064623}{
real(stm\_\-real), parameter \textbf{k\_\-0} = 10.066637844459d0}
\label{a00075_eb86253215997660050af69310064623}

\item 
\hypertarget{a00075_3d1a8e7d7d206a6c8c4d8565ae42d4c4}{
real(stm\_\-real), parameter \textbf{start\_\-time} = zero}
\label{a00075_3d1a8e7d7d206a6c8c4d8565ae42d4c4}

\item 
\hypertarget{a00075_388d4f0c2ae48eae0d24c20926515581}{
real(stm\_\-real), parameter \textbf{end\_\-time} = 124d0}
\label{a00075_388d4f0c2ae48eae0d24c20926515581}

\item 
\hypertarget{a00075_21dd7d4370f255884d0575af7c1f72d2}{
real(stm\_\-real), parameter \hyperlink{a00075_21dd7d4370f255884d0575af7c1f72d2}{amplitude} = fourth}
\label{a00075_21dd7d4370f255884d0575af7c1f72d2}

\begin{CompactList}\small\item\em Tidal amplitude in meter. \item\end{CompactList}\item 
\hypertarget{a00075_95529fc80d0c9206dee17d7defe1cd1c}{
real(stm\_\-real), parameter \hyperlink{a00075_95529fc80d0c9206dee17d7defe1cd1c}{sec\_\-per\_\-hr} = 60.d0$\ast$60.d0}
\label{a00075_95529fc80d0c9206dee17d7defe1cd1c}

\begin{CompactList}\small\item\em Convert factor of hour to second. \item\end{CompactList}\item 
\hypertarget{a00075_7069493925339bc094dc5d9e66a6ca3e}{
real(stm\_\-real), parameter \hyperlink{a00075_7069493925339bc094dc5d9e66a6ca3e}{m2\_\-period} = 12.4d0$\ast$sec\_\-per\_\-hr}
\label{a00075_7069493925339bc094dc5d9e66a6ca3e}

\begin{CompactList}\small\item\em M2 tidal period. \item\end{CompactList}\item 
\hypertarget{a00075_685c107d67e4166e5c47350e344ff0e1}{
real(stm\_\-real), parameter \hyperlink{a00075_685c107d67e4166e5c47350e344ff0e1}{freq} = two$\ast$pi/\hyperlink{a00075_7069493925339bc094dc5d9e66a6ca3e}{m2\_\-period}}
\label{a00075_685c107d67e4166e5c47350e344ff0e1}

\begin{CompactList}\small\item\em Frequency of tidal oscillation. \item\end{CompactList}\end{CompactItemize}


\subsection{Detailed Description}
Testing \hyperlink{a00052}{advection} of mass which is subjected to a tidal boundary. 



\subsection{Function/Subroutine Documentation}
\hypertarget{a00075_274a3add96450377dc8a8b3a940b9b92}{
\index{test\_\-advection\_\-tidal@{test\_\-advection\_\-tidal}!initial\_\-fine\_\-solution\_\-tidal@{initial\_\-fine\_\-solution\_\-tidal}}
\index{initial\_\-fine\_\-solution\_\-tidal@{initial\_\-fine\_\-solution\_\-tidal}!test_advection_tidal@{test\_\-advection\_\-tidal}}
\subsubsection[{initial\_\-fine\_\-solution\_\-tidal}]{\setlength{\rightskip}{0pt plus 5cm}subroutine test\_\-advection\_\-tidal.initial\_\-fine\_\-solution\_\-tidal (real(stm\_\-real),dimension(nx\_\-base,nconc),intent(out) {\em fine\_\-initial\_\-condition}, \/  real(stm\_\-real),dimension(nx\_\-base,nconc),intent(out) {\em fine\_\-solution}, \/  integer,intent(in) {\em nx\_\-base}, \/  integer,intent(in) {\em nconc}, \/  real(stm\_\-real),intent(in) {\em origin}, \/  real(stm\_\-real),intent(in) {\em domain\_\-length}, \/  real(stm\_\-real),intent(in) {\em ic\_\-gaussian\_\-sd}, \/  real(stm\_\-real),intent(in) {\em solution\_\-gaussin\_\-sd}, \/  real(stm\_\-real),intent(in) {\em ic\_\-center}, \/  real(stm\_\-real),intent(in) {\em solution\_\-center})}}
\label{a00075_274a3add96450377dc8a8b3a940b9b92}


load the initial values and reference final values to feed the test routine 

The general subroutine which gets the fine initial and reference values from the privious subroutine and compute the norms, after each step coarsen the values and repeat computation. at the end calculates the ratio of the norms and prints a log Generates a fine initial and final solution of mass \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em fine\_\-initial\_\-condition}]initial condition at finest resolution\item[{\em fine\_\-solution}]reference solution at finest resolution\item[{\em origin}]Left hand side of the channel\item[{\em domain\_\-length}]Domain length\item[{\em ic\_\-gaussian\_\-sd}]Standard deviation of initial value\item[{\em solution\_\-gaussin\_\-sd}]Standard deviation of solution \item[{\em ic\_\-center}]Center of fine initial value\item[{\em solution\_\-center}]Center of solution \end{description}
\end{Desc}
\hypertarget{a00075_a641e8962260d8ad121308cc9b47f0ba}{
\index{test\_\-advection\_\-tidal@{test\_\-advection\_\-tidal}!tidal\_\-flow@{tidal\_\-flow}}
\index{tidal\_\-flow@{tidal\_\-flow}!test_advection_tidal@{test\_\-advection\_\-tidal}}
\subsubsection[{tidal\_\-flow}]{\setlength{\rightskip}{0pt plus 5cm}subroutine test\_\-advection\_\-tidal::tidal\_\-flow (real(stm\_\-real),dimension(ncell),intent(out) {\em flow}, \/  real(stm\_\-real),dimension(ncell),intent(out) {\em flow\_\-lo}, \/  real(stm\_\-real),dimension(ncell),intent(out) {\em flow\_\-hi}, \/  real(stm\_\-real),dimension(ncell),intent(out) {\em area}, \/  real(stm\_\-real),dimension(ncell),intent(out) {\em area\_\-lo}, \/  real(stm\_\-real),dimension(ncell),intent(out) {\em area\_\-hi}, \/  integer,intent(in) {\em ncell}, \/  real(stm\_\-real),intent(in) {\em time}, \/  real(stm\_\-real),intent(in) {\em dx}, \/  real(stm\_\-real),intent(in) {\em dt})}}
\label{a00075_a641e8962260d8ad121308cc9b47f0ba}


generates a tidal flow to feed a pointer 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em flow}]cell and time centered flow\item[{\em flow\_\-lo}]lo face flow, time centered\item[{\em flow\_\-hi}]hi face flow, time centered\item[{\em area}]cell center area, old time\item[{\em area\_\-lo}]area lo face, time centered\item[{\em area\_\-hi}]area hi face, time centered\item[{\em ncell}]number of cells\item[{\em time}]time of request \char`\"{}old time\char`\"{}\item[{\em dx}]spatial step \item[{\em dt}]time step \end{description}
\end{Desc}
